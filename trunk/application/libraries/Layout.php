<?php  if (!defined('BASEPATH')) exit('No direct script access allowed');/** * 頁面模板 */class Layout{    var $obj;    var $layout;        function __construct()    {        $this->obj =& get_instance();				// 默認加載 jNotify -- 提示框		$this->loadJs('jNotify');    }	// ------------------------------------------------------------------------		/**	 * 設置模板	 */    function setLayout($layout='main')    {		$this->layout	= $layout;    }		// ------------------------------------------------------------------------		/**	 * 加載Js	 * 配合 js_helper 使用	 */	function loadJs($jsName) 	{		if(!empty($this->obj->ViewBag['_loadJs']))			$loadJsList = $this->obj->ViewBag['_loadJs'];		else			$loadJsList = array();				if ( ! empty($jsName) && ! in_array($jsName,$loadJsList)) {			$this->obj->ViewBag['_loadJs'][] = $jsName;		}	}    	// ------------------------------------------------------------------------		/**	 * 加載view文件。	 *	 * $data 默認是 CI_Controller 子類的屬性 ViewBag。	 * $view 默認是 根據 CI_Controller屬性 uri 分析出。user/login 對應 user/login.php view文件	 */    function view($view='', $data='', $return=false)    {		if(empty($data))			$data =& $this->obj->ViewBag;        		if(empty($view)) {			$uri =& $this->obj->uri;						$directory = trim($CI->router->directory,'/');						if(empty($directory))				$view = $uri->rsegments[1].'/'.$uri->rsegments[2];			else				$view = $directory.'/'.$uri->rsegments[1].'/'.$uri->rsegments[2];		}		        $data['_content_for_layout'] = $this->obj->load->view($view,$data,true);		if($return) {            $output = $this->obj->load->view($this->layout, $data, true);            return $output;        } else {            $this->obj->load->view($this->layout, $data, false);        }    }}